RewriteEngine On

# Redirecionar para HTTPS (opcional, descomente se necessário)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Rotas amigáveis
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Rota /presentes - lista de presentes
RewriteRule ^presentes/?$ lista.php [L]

# Rota /login - área de login do admin
RewriteRule ^login/?$ admin/login.php [L]

# Rota /admin - dashboard do admin
RewriteRule ^admin/?$ admin/dashboard.php [L]

# Rota /admin/recados - área de recados do admin
RewriteRule ^admin/recados/?$ admin/recados.php [L]

# Rota /admin/pix_transactions - histórico de transações PIX
RewriteRule ^admin/pix_transactions/?$ admin/pix_transactions.php [L]

# Rota /admin/gifts - gestão de presentes do admin
RewriteRule ^admin/gifts/?$ admin/gifts.php [L]

# Rota /recados - área de recados do admin (alternativa)
RewriteRule ^recados/?$ admin/recados.php [L]

# Rota /api/send_recado - API para envio de recados
RewriteRule ^api/send_recado/?$ api/send_recado.php [L]

# Rota /api/save_pix_transaction - API para salvar transação PIX
RewriteRule ^api/save_pix_transaction/?$ api/save_pix_transaction.php [L]

# Rota /api/update_pix_status - API para atualizar status PIX
RewriteRule ^api/update_pix_status/?$ api/update_pix_status.php [L]

# Rota /api/generate_pix - API para geração de PIX
RewriteRule ^api/generate_pix/?$ api/generate_pix.php [L]

# Proteger arquivos sensíveis
<Files "config.php">
    Order Allow,Deny
    Deny from all
</Files>

<Files "*.sql">
    Order Allow,Deny
    Deny from all
</Files>

# Configurações de segurança
Header always set X-Content-Type-Options nosniff
Header always set X-Frame-Options DENY
Header always set X-XSS-Protection "1; mode=block"

# Cache para assets estáticos
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/svg+xml "access plus 1 month"
</IfModule>

# Compressão GZIP
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>